!function(r,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.rnautils=t():r.rnautils=t()}(this,function(){return function(r){function t(n){if(e[n])return e[n].exports;var a=e[n]={exports:{},id:n,loaded:!1};return r[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var e={};return t.m=r,t.c=e,t.p="",t(0)}([function(r,t,e){r.exports=e(1)},function(r,t){"use strict";function e(r,t){if(r===t)return!0;if(null===r||null===t)return!1;if(r.length!=t.length)return!1;for(var e=0;e<r.length;++e)if(r[e]!==t[e])return!1;return!0}function n(){var r=this;r.bracketLeft="([{<ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),r.bracketRight=")]}>abcdefghijklmnopqrstuvwxyz".split(""),r.inverseBrackets=function(r){for(var t={},e=0;e<r.length;e++)t[r[e]]=e;return t},r.maximumMatching=function(r){for(var t=r[0],e=0,n=new Array(t+1),a=0;t>=a;a++){n[a]=new Array(t+1);for(var o=a;t>=o;o++)n[a][o]=0}for(var i=0,a=t-e-1;a>0;a--)for(var o=a+e+1;t>=o;o++){i=n[a][o-1];for(var f=o-e-1;f>=a;f--)r[f]===o&&(i=Math.max(i,(f>a?n[a][f-1]:0)+1+(o-f-1>0?n[f+1][o-1]:0)));n[a][o]=i}return i=n[1][t],n},r.backtrackMaximumMatching=function(t,e){var n=Array.apply(null,Array(t.length)).map(function(){return 0});return r.mmBt(t,n,e,1,t.length-1),n},r.mmBt=function(t,e,n,a,o){var i=t[a][o],f=0;if(!(f>o-a-1)){if(t[a][o-1]==i)return void r.mmBt(t,e,n,a,o-1);for(var u=o-f-1;u>=a;u--)if(n[o]===u){var c=u>a?t[a][u-1]:0,l=o-u-1>0?t[u+1][o-1]:0;if(c+l+1==i)return e[u]=o,e[o]=u,u>a&&r.mmBt(t,e,n,a,u-1),void r.mmBt(t,e,n,u+1,o-1)}console.log("FAILED!!!"+a+","+o+": backtracking failed!")}},r.dotbracketToPairtable=function(t){var e=Array.apply(null,new Array(t.length+1)).map(Number.prototype.valueOf,0);e[0]=t.length;for(var n={},a=0;a<r.bracketLeft.length;a++)n[a]=[];for(var o=r.inverseBrackets(r.bracketLeft),i=r.inverseBrackets(r.bracketRight),a=0;a<t.length;a++){var f=t[a],u=a+1;if("."==f||"o"==f)e[u]=0;else if(f in o)n[o[f]].push(u);else{if(!(f in i))throw"Unknown symbol in dotbracket string";var c=n[i[f]].pop();e[u]=c,e[c]=u}}for(var l in n)if(n[l].length>0)throw"Unmatched base at position "+n[l][0];return e},r.insertIntoStack=function(r,t,e){for(var n=0;r[n].length>0&&r[n][r[n].length-1]<e;)n+=1;return r[n].push(e),n},r.deleteFromStack=function(r,t){for(var e=0;0===r[e].length||r[e][r[e].length-1]!=t;)e+=1;return r[e].pop(),e},r.pairtableToDotbracket=function(t){for(var e={},n=0;n<t[0];n++)e[n]=[];for(var n,a={},o="",n=1;n<t[0]+1;n++){if(0!==t[n]&&t[n]in a)throw"Invalid pairtable contains duplicate entries";a[t[n]]=!0,o+=0===t[n]?".":t[n]>n?r.bracketLeft[r.insertIntoStack(e,n,t[n])]:r.bracketRight[r.deleteFromStack(e,n)]}return o},r.findUnmatched=function(t,e,n){for(var a,o=[],i=[],f=e,u=n,a=e;n>=a;a++)0!==t[a]&&(t[a]<e||t[a]>n)&&i.push([a,t[a]]);for(var a=f;u>=a;a++){for(;0===t[a]&&u>=a;)a++;for(n=t[a];t[a]===n;)a++,n--;o=o.concat(r.findUnmatched(t,a,n))}return i.length>0&&o.push(i),o},r.removePseudoknotsFromPairtable=function(t){for(var e=r.maximumMatching(t),n=r.backtrackMaximumMatching(e,t),a=[],o=1;o<t.length;o++)t[o]<o||n[o]!=t[o]&&(a.push([o,t[o]]),t[t[o]]=0,t[o]=0);return a}}Object.defineProperty(t,"__esModule",{value:!0}),t.arraysEqual=e,t.RNAUtilities=n;t.rnaUtilities=new n}])});