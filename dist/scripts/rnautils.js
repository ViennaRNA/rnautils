!function(r,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.rnautils=t():r.rnautils=t()}(this,function(){return function(r){function t(n){if(e[n])return e[n].exports;var o=e[n]={exports:{},id:n,loaded:!1};return r[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var e={};return t.m=r,t.c=e,t.p="",t(0)}([function(r,t,e){r.exports=e(1)},function(r,t){"use strict";function e(r,t){if(r===t)return!0;if(null===r||null===t)return!1;if(r.length!=t.length)return!1;for(var e=0;e<r.length;++e)if(r[e]!==t[e])return!1;return!0}function n(){var r=this;r.bracketLeft="([{<ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),r.bracketRight=")]}>abcdefghijklmnopqrstuvwxyz".split(""),r.inverseBrackets=function(r){for(var t={},e=0;e<r.length;e++)t[r[e]]=e;return t},r.maximumMatching=function(r){for(var t=r[0],e=0,n=new Array(t+1),o=0;t>=o;o++){n[o]=new Array(t+1);for(var a=o;t>=a;a++)n[o][a]=0}for(var i=0,o=t-e-1;o>0;o--)for(var a=o+e+1;t>=a;a++){i=n[o][a-1];for(var u=a-e-1;u>=o;u--)r[u]===a&&(i=Math.max(i,(u>o?n[o][u-1]:0)+1+(a-u-1>0?n[u+1][a-1]:0)));n[o][a]=i}return i=n[1][t],n},r.backtrackMaximumMatching=function(t,e){var n=Array.apply(null,Array(t.length)).map(function(){return 0});return r.mmBt(t,n,e,1,t.length-1),n},r.mmBt=function(t,e,n,o,a){var i=t[o][a],u=0;if(!(u>a-o-1)){if(t[o][a-1]==i)return void r.mmBt(t,e,n,o,a-1);for(var f=a-u-1;f>=o;f--)if(n[a]===f){var s=f>o?t[o][f-1]:0,c=a-f-1>0?t[f+1][a-1]:0;if(s+c+1==i)return e[f]=a,e[a]=f,f>o&&r.mmBt(t,e,n,o,f-1),void r.mmBt(t,e,n,f+1,a-1)}console.log("FAILED!!!"+o+","+a+": backtracking failed!")}},r.dotbracketToPairtable=function(t){var e=Array.apply(null,new Array(t.length+1)).map(Number.prototype.valueOf,0);e[0]=t.length;for(var n={},o=0;o<r.bracketLeft.length;o++)n[o]=[];for(var a=r.inverseBrackets(r.bracketLeft),i=r.inverseBrackets(r.bracketRight),o=0;o<t.length;o++){var u=t[o],f=o+1;if("."==u||"o"==u)e[f]=0;else if(u in a)n[a[u]].push(f);else{if(!(u in i))throw"Unknown symbol in dotbracket string";var s=n[i[u]].pop();e[f]=s,e[s]=f}}for(var c in n)if(n[c].length>0)throw"Unmatched base at position "+n[c][0];return e},r.insertIntoStack=function(r,t,e){for(var n=0;r[n].length>0&&r[n][r[n].length-1]<e;)n+=1;return r[n].push(e),n},r.deleteFromStack=function(r,t){for(var e=0;0===r[e].length||r[e][r[e].length-1]!=t;)e+=1;return r[e].pop(),e},r.pairtableToDotbracket=function(t){for(var e={},n=0;n<t[0];n++)e[n]=[];for(var n,o={},a="",n=1;n<t[0]+1;n++){if(0!==t[n]&&t[n]in o)throw"Invalid pairtable contains duplicate entries";o[t[n]]=!0,a+=0===t[n]?".":t[n]>n?r.bracketLeft[r.insertIntoStack(e,n,t[n])]:r.bracketRight[r.deleteFromStack(e,n)]}return a},r.findUnmatched=function(t,e,n){for(var o,a=[],i=[],u=e,f=n,o=e;n>=o;o++)0!==t[o]&&(t[o]<e||t[o]>n)&&i.push([o,t[o]]);for(var o=u;f>=o;o++){for(;0===t[o]&&f>=o;)o++;for(n=t[o];t[o]===n;)o++,n--;a=a.concat(r.findUnmatched(t,o,n))}return i.length>0&&a.push(i),a},r.removePseudoknotsFromPairtable=function(t){for(var e=r.maximumMatching(t),n=r.backtrackMaximumMatching(e,t),o=[],a=1;a<t.length;a++)t[a]<a||n[a]!=t[a]&&(o.push([a,t[a]]),t[t[a]]=0,t[a]=0);return o},r.ptToElements=function(t,e,n,a,i){var u=[],f=[n-1],s=[a+1];if(arguments.length<5&&(i=[]),n>a)return[];for(;0===t[n];n++)f.push(n);for(;0===t[a];a--)s.push(a);if(n>a){if(f.push(n),0===e)return[["e",e,f.sort(o)]];for(var c=!1,l=[],h=[],p=0;p<f.length;p++)c?h.push(f[p]):l.push(f[p]),i.indexOf(f[p])>=0&&(c=!0);return c?[["h",e,f.sort(o)]]:[["h",e,f.sort(o)]]}if(t[n]!=a){var v=f,p=n;for(v.push(p);a>=p;){for(u=u.concat(r.ptToElements(t,e,p,t[p],i)),v.push(t[p]),p=t[p]+1;0===t[p]&&a>=p;p++)v.push(p);v.push(p)}return v.pop(),v=v.concat(s),v.length>0&&(0===e?u.push(["e",e,v.sort(o)]):u.push(["m",e,v.sort(o)])),u}if(t[n]===a){f.push(n),s.push(a);var m=f.concat(s);m.length>4&&(0===e?u.push(["e",e,f.concat(s).sort(o)]):u.push(["i",e,f.concat(s).sort(o)]))}for(var g=[];t[n]===a&&a>n;)g.push(n),g.push(a),n+=1,a-=1,e+=1;return f=[n-1],s=[a+1],u.push(["s",e,g.sort(o)]),u.concat(r.ptToElements(t,e,n,a,i))}}Object.defineProperty(t,"__esModule",{value:!0}),t.arraysEqual=e,t.RNAUtilities=n;var o=function(r,t){return r-t};t.rnaUtilities=new n}])});